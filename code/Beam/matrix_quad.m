function [T]=matrix_quad(L,K,E)
% give 6*6 transfert matrix for quadrupole
% L length m
% K G/Brho
% E

if K>0 
    K=sqrt(K);
    c=cos(K*L);s=sin(K*L);ch=cosh(K*L);sh=sinh(K*L);
    T=[c  s/K  0   0   0   0 ; ...
      -K*s c   0   0   0   0 ; ...
       0  0   ch sh/K  0   0 ; ...
       0  0   K*sh ch  0   0 ; ...
       0  0    0   0   1   0 ; ...
       0  0    0   0   0   1];
elseif K<0
    K=sqrt(-K);
    c=cos(K*L);s=sin(K*L);ch=cosh(K*L);sh=sinh(K*L);
    T=[ch  sh/K  0   0   0   0 ; ...
      K*sh ch   0   0   0   0 ; ...
      0  0   c  s/K  0   0 ; ...
      0  0   -K*s c  0   0 ; ...
      0  0    0   0   1   0 ; ...
      0  0    0   0   0   1];
else
    T=[1  L  0   0   0   0 ; ...
       0  1   0   0   0   0 ; ...
       0  0   1  L  0   0 ; ...
       0  0   0  1  0   0 ; ...
       0  0    0   0   1   0 ; ...
       0  0    0   0   0   1];
end


return