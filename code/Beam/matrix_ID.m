function [T]=matrix_ID(L,K)
% give 6*6 transfert matrix for ID : only vertical or helical focusing
% L length    (m)
% K Brho/Bmax (m)  or rho min (Bmax)
% E

if length(K)==1 ; K(2)=0; end

if K(2)==0                  % Planar undulator
    K=1/abs(K(1))/sqrt(2);  % Mean radius over 1 period sinus
    c=cos(K*L);s=sin(K*L);
    T=[1  L  0   0   0   0 ; ...
      0  1   0   0   0   0 ; ...
      0  0   c  s/K  0   0 ; ...
      0  0   -K*s c  0   0 ; ...
      0  0    0   0   1   0 ; ...
      0  0    0   0   0   1];  
elseif K(2)==1              % for helical undulator 
    K=1/abs(K(1))/2;     
    c=cos(K*L);s=sin(K*L);
    T=[c  s/K  0   0   0   0 ; ...
      -K*s  c   0   0   0   0 ; ...
      0  0   c  s/K  0   0 ; ...
      0  0   -K*s c  0   0 ; ...
      0  0    0   0   1   0 ; ...
      0  0    0   0   0   1];
else
    T=[1  L  0   0   0   0 ; ...
       0  1   0   0   0   0 ; ...
       0  0   1  L  0   0 ; ...
       0  0   0  1  0   0 ; ...
       0  0    0   0   1   0 ; ...
       0  0    0   0   0   1];
end


return